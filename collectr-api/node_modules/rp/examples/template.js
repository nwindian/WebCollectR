var rp = require("../");

var _uid = 0;

function template(data) {
	return rp.computed(function() {
		var uid = _uid++;
		var element = document.createElement("div");
		element.innerHTML = rp.computed(html).getHandled(function(html) {
			element.innerHTML = html;
		});

		var b = element.getElementsByClassName("rp-b" + uid)[0];
		b.onkeyup = b.oninput = function() {
			data("header").set(b.value);
		};

		return element;

		function html() {
			return "<h1 class='rp-a" + uid + "'>" + data("header").getHandled(function(header) {
				element.getElementsByClassName("rp-a" + uid)[0].innerHTML = header;
			}) + "</h1><p><input type='text' class='rp-b" + uid + "' value='" + data("header").getHandled(function(header) {
				element.getElementsByClassName("rp-b" + uid)[0].value = header;
			}) + "' /></p>";
		}
	});
}

var info = rp.variable({
	header: "Header"
});

window.onload = function() {
	document.body.appendChild(template(info).scope()());
}